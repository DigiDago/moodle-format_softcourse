define(["jquery","core/ajax","theme_boost/tooltip"],function(e,t){return{init:function(){M.course=M.course||{},M.course.format=M.course.format||{},M.course.format.get_config=function(){return{container_node:"ul",container_class:"softcourse",section_node:"li",section_class:"section"}},M.course.format.swap_sections=function(e,t,o){let n="course-content",a="section_add_menus",s=e.Node.all("."+n+" "+M.course.format.get_section_selector(e));s.item(t).one("."+a).swap(s.item(o).one("."+a))},M.course.format.process_sections=function(e,t,o,n,a){let s="sectionname",i=".left .section-handle .icon";if("move"===o.action){if(n>a){let e=a;a=n,n=e}let r,c,l,u;for(let d=n;d<=a;d++){let n=e.Node.create("<span>"+o.sectiontitles[d]+"</span>");t.item(d).all("."+s).setHTML(n),l=(c=(r=t.item(d).one(i)).getAttribute("alt")).lastIndexOf(" "),u=c.substr(0,l+1)+d,r.setAttribute("alt",u),r.setAttribute("title",u)}}},e(".section-file").on("change",function(o){let n=o.target.dataset.sectionid,a=o.target.dataset.courseid;if(console.log(a),a){let s=o.target.files[0],i=null;if(!s.type.match("image.*"))return;let r=this,c=new FileReader;c.onload=(s=s,function(o){i=o.target.result,e(r).parent().parent().css("background-image","url("+i+")"),e(r).parent().parent().addClass("not-empty");let c=i.split("base64,")[1],l=s.name;t.call([{methodname:"format_softcourse_update_section_image",args:{courseid:a,sectionid:n,imagedata:c,filename:l},fail:function(e){window.console.error(e)}}],!0,!0)}),c.readAsDataURL(s)}var s}),e(".section-delete-file").on("click",function(o){o.preventDefault(),o.stopPropagation();let n=o.target.dataset.sectionid,a=o.target.dataset.courseid;e(this).parent().parent().css("background-image","none"),e(this).parent().parent().removeClass("not-empty"),t.call([{methodname:"format_softcourse_delete_section_image",args:{courseid:a,sectionid:n},fail:function(e){window.console.error(e)}}],!0,!0)}),e('[data-toggle="tooltip"]').tooltip()}}});